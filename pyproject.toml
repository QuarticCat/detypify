[project]
name = "detypify-model"
version = "0.2.4"
requires-python = ">=3.13, <3.14"
authors = [
  { name = "QuarticCat", email = "QuarticCat@pm.me" },
  { name = "Cloud0310", email = "gh@touchingfish.day" }
]
dependencies = [
  # migrate
  "beautifulsoup4>=4.14.3",
  "fonttools[woff]>=4.61.0",
  "lightning>=2.6.0",
  "lxml>=6.0.2",
  "msgspec>=0.20.0",
  # onnx model export
  "onnx>=1.20.0",
  "onnxscript>=0.5.7",
  "pillow>=12.0.0",
  "pillow>=12.0.0",
  "rocksdict>=0.3.29",
  "timm>=1.0.22",
  # for pre-trained models
  "timm>=1.0.22",
  # for model training
  "torch>=2.9.1",
  "torchvision>=0.24.1",
]

[dependency-groups]
dev = [
  "ipython>=9.9.0",
  "lxml-stubs>=0.5.1",
  # tensorboard logging faciliity
  "pyrefly",
  "tensorboard>=2.20.0",
  "tensorboardx>=2.6.4",
  "torch-tb-profiler",
  "torch-tb-profiler>=0.4.3",
  "zuban",
]

[tool.ruff.lint.isort]
known-local-folder = ["proc_*"]

[tool.uv]
conflicts = [
  [
    { extra = "cpu" },
    { extra = "gpu" },
  ]
]

[tool.uv.sources]
torch = [
  { index = "torch-cpu", extra = "cpu" },
  { index = "torch-cu130", extra = "gpu" }
]
torchvision = [
  { index = "torch-cpu", extra = "cpu" },
  { index = "torch-cu130", extra = "gpu" }
]

[[tool.uv.index]]
name = "pytorch-cu130"
url = "https://download.pytorch.org/whl/cu130"
explicit = true

[[tool.uv.index]]
name = "torch-cpu"
url = "https://download.pytorch.org/whl/cpu"
explicit = true

[[tool.uv.index]]
name = "torch-cpu"
url = "https://download.pytorch.org/whl/cpu"
explicit = true

# zuban sys.path finding, for python lsp
[tool.zuban]
mypy_path = ["python"]
